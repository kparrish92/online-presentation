angular.module("buylist.app",["ngRoute"]).config(["$httpProvider","$locationProvider","$routeProvider",function(t,e,r){t.defaults.headers.post||(t.defaults.headers.common={}),t.defaults.headers.common["Cache-Control"]="no-cache",t.defaults.headers.common.Pragma="no-cache",t.defaults.headers.common["If-Modified-Since"]="0",e.html5Mode(!1).hashPrefix("!"),r.when("/",{controller:"MainController",templateUrl:"./views/main.html"}).when("/Bulk",{controller:"DeptsWithBulkController",templateUrl:"./views/deptswithbulk.html"}).when("/cartreview",{controller:"CartReviewController",templateUrl:"./views/cartreview.html"}).when("/search/:deptCode/:searchwords",{controller:"SearchController",templateUrl:"./views/search.html"}).when("/:deptCode",{controller:"CategoryListController",templateUrl:"./views/categorylist.html"}).when("/:deptCode/Bulk",{controller:"BulkBuylistController",templateUrl:"./views/bulkbuylist.html"}).when("/:deptCode/Hotbuys",{controller:"HotbuysBuylistController",templateUrl:"./views/hotbuysbuylist.html"}).when("/:deptCode/:catid",{controller:"DeptBuylistController",templateUrl:"./views/deptbuylist.html"}).otherwise({redirectTo:"/"})}]).run(["GoogleAnalytics",function(t){}]).factory("System",["$http","$timeout",function(t,e){return{location:function(){return window.location},protocol:function(){return window.location.protocol},hostname:function(){return window.location.hostname},pathname:function(){return window.location.pathname},homeurl:function(){return this.protocol()+"//"+this.hostname()},buylisturl:function(){return this.homeurl()+"/buylist/#!/"},isDev:function(){var t=!1,e=this.hostname();return-1!=e.indexOf("www")&&-1!=e.indexOf("service")||(t=!0),t},isFromBeta:function(){return!0===window.isFromBeta},betaUrl:function(){return window.betaUrl},httpcdn:function(){return"https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com"},httpscdn:function(){return"https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com"},log:function(t){var e=!1;this.isDev()&&(e=!0),e&&window.console&&console.log(t)}}}]).factory("Buylist",["System","$http","$route","$location","$timeout",function(t,e,r,a,i){return{BuylistAction:function(r,a,i,o){return e({url:t.homeurl()+"/buylist/ajax_scripts/buylist.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:{action:r,productid:a,deptCode:i,catid:o,random:(new Date).getTime()}})},CartNotification:function(t){var e=$("div.buylist-notification");$(window).scrollTop();5===e.length&&$(e).last(function(){}).fadeOut(100,function(){$(this).remove()}),e.length>0&&e.each(function(){var t=$(this).css("top");t=parseInt(t.replace("px","")),t+=28,t+="px",$(this).css("top",t)});var r=$("<div>",{class:"buylist-notification"});r.css("background-color","white"),r.css("border","1px solid #AAA"),r.css("border-radius","5px"),r.css("clear","both"),r.css("display","none"),r.css("float","left"),r.css("height","100%"),r.css("padding","5px"),r.css("position","absolute"),r.css("top","155px"),r.css("right","15px"),r.css("text-align","center"),r.css("width","300px"),r.css("z-index","1001"),r.append(t),$("header#buylistHeader").prepend(r),$(r).show(function(){i(function(){$(r).fadeOut(2e3,function(){$(r).remove()})},5e3)})},GetCart:function(){return e({url:"./ajax_scripts/buylist.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:{action:"loadcartcache",random:(new Date).getTime()}})},keydown:function(t){var e=t.keyCode||t.charCode||t.which;return 8==e||9==e||13==e||27==e||46==e||e>=48&&e<=57||e>=96&&e<=105||1==t.ctrlKey&&65==e||(t.preventDefault(),!1)},keyup:function(t){var e=$("."+t+".buylist_sellqty input").val();if(e||(e=$("."+t+".cartreview_sellqty input").val()),(e=e.trim()).indexOf(",")&&(e=e.replace(",","")),e=parseInt(e),""!==$("."+t+".buylist_buyqty span:first-child").text())var r=$("."+t+".buylist_buyqty span:first-child").text();else r=$("."+t+".buylist_buyqty span:last-child").text();if(!r)if(""!==$("."+t+".cartreview_buyqty span:first-child").text())r=$("."+t+".cartreview_buyqty span:first-child").text();else r=$("."+t+".cartreview_buyqty span:last-child").text();if((r=r.trim()).indexOf(",")&&(r=r.replace(",","")),r=parseInt(r),1==$("."+t+".buylist_buyprice span input").length)var a=$("."+t+".buylist_buyprice span input").val();else a=$("."+t+".buylist_buyprice span").text();if(!a)if(1==$("."+t+".cartreview_buyprice span input").length)a=$("."+t+".cartreview_buyprice span input").val();else a=$("."+t+".cartreview_buyprice span").text();return(a=a.trim()).indexOf(",")&&(a=a.replace(",","")),a=parseFloat(a),e>r&&(e=r,1==$("."+t+".buylist_sellqty input").length?$("."+t+".buylist_sellqty input").val(e):$("."+t+".cartreview_sellqty input").val(e)),this.update(t,e,a)},processSellQty:function(t){var e=this,a=$(t).attr("data-pdid"),i=$("."+a+".buylist_buyqty span").text(),o=!1;if(!i){i=$("."+a+".cartreview_sellqty input").val();o=!0}i=parseInt(i),e.keyup(a).success(function(t,n,s,c){if("OK"==t.Response){1==o&&r.reload();var l=$("."+a+".buylist_sellqty input").val();if(l<i)var u='<img src="https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com/media/Buylist2.0/AddtoCartButtonNormal.png" alt="Add To Cart">';else u="";if(0==l)var d="";else d="x";if(msg=0==l?"Item removed from Buylist Cart!":"Item added to Buylist Cart!",$("."+a+".buylist_add span").html(u),$("."+a+".buylist_clear span").text(d),""!==u){var p=$("."+a+".buylist_add").children("span").children("img");p.mouseover(function(){var t=$(this).attr("src");t=t.replace("Hover","Normal"),$(this).attr("src",t)}).mouseout(function(){var t=$(this).attr("src");t=t.replace("Normal","Hover"),$(this).attr("src",t)}),p.click(function(){e.update("Add",a).success(function(t,r,i,o){if("OK"==t.Response){var n=$("."+a+".buylist_buyqty span").text();n=parseInt(n);var s=$("."+a+".buylist_sellqty input").val(),c='<img src="https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com/media/Buylist2.0/AddtoCartButtonNormal.png" alt="Add To Cart">';if((s=parseInt(s))<n&&(s+=1),s==n&&(c=""),0==s)var l="";else l="x";$("."+a+".buylist_sellqty input").val(s),""==c&&$("."+a+".buylist_add span").html(c),$("."+a+".buylist_clear span").text(l),e.GetCart().success(function(t,r,a,i){if(1==parseInt(t.response)){var o="Your Cart ("+t.totalqty+") $"+parseFloat(t.totalprice).toFixed(2);$("#accountDiv .YourCart .YourCartInner .qty_price a").text(o),e.CartNotification("Item added to Buylist Cart!")}})}})})}e.GetCart().success(function(t,r,a,i){if(1==parseInt(t.response)){var o="Your Cart ("+t.totalqty+") $"+parseFloat(t.totalprice).toFixed(2);$("#accountDiv .YourCart .YourCartInner .qty_price a").text(o),e.CartNotification(msg)}})}})},search:function(t,r){return e({url:"./ajax_scripts/buylist.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:{action:"buylistsearch",deptCode:t,searchwords:r}})},processUpdate:function(t,e){if((r=$("."+e+".buylist_sellqty input").val())||(r=$("."+e+".cartreview_sellqty input").val()),(r=r.trim()).indexOf(",")&&(r=r.replace(",","")),r=parseInt(r),"Add"==t)r+=1;else var r=0;if(""!==$("."+e+".buylist_buyqty span:first-child").text())var a=$("."+e+".buylist_buyqty span:first-child").text();else a=$("."+e+".buylist_buyqty span:last-child").text();if(!a)if(""!==$("."+e+".cartreview_buyqty span:first-child").text())a=$("."+e+".cartreview_buyqty span:first-child").text();else a=$("."+e+".cartreview_buyqty span:last-child").text();if((a=a.trim()).indexOf(",")&&(a=a.replace(",","")),a=parseInt(a),1==$("."+e+".buylist_buyprice span input").length)var i=$("."+e+".buylist_buyprice span input").val();else i=$("."+e+".buylist_buyprice span").text();if(!i)if(1==$("."+e+".cartreview_buyprice span input").length)i=$("."+e+".cartreview_buyprice span input").val();else i=$("."+e+".cartreview_buyprice span").text();return(i=i.trim()).indexOf(",")&&(i=i.replace(",","")),i=parseFloat(i),r>a&&(r=a,1==$("."+e+".buylist_sellqty input").length?$("."+e+".buylist_sellqty input").val(r):$("."+e+".cartreview_sellqty input").val(r)),this.update(e,r,i)},update:function(t,r,a){return e({url:"./ajax_scripts/buylist.php",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:{action:"updateoneproduct",pdid:t,sellqty:r,buyprice:a,random:(new Date).getTime()}})}}}]).factory("GoogleAnalytics",["$rootScope","$location","$window","System",function(t,e,r,a){var i={SendPageView:function(){r.ga&&r.ga("send","pageview",{page:e.path()})}};return t.$on("$viewContentLoaded",i.SendPageView),i}]).filter("startFrom",function(){return function(t,e){return e=+e,t.slice(e)}}).filter("range",function(){return function(t,e){e=parseInt(e);for(var r=0;r<e;r++)t.push(r);return t}}).directive("loading",["$http",function(t){return{restrict:"A",link:function(e,r,a){e.LoadingTextArr=["Evaluating the Geometric Measure of Quantum Discord...","Assembling Products...","Talking To The Precious...","Counting Neutrinos In A Grain Of Sand...","Calculating Buy Prices...","Repairing the Flux Capacitor...","Finding A Fruit Basket...","Building Category Lists...","Making a Sandwich","Journeying To An Entmoot...","Engaging the Hyperdrive...","Using the Force...","Making The Jump To Lightspeed...","Evaluating Qty Needed...","Taking The Hobbits To Isengard...","Looking for the Hotlist...","Don't Stop Believing...","Tearing Tags Off Mattresses...","Throwing The One Ring Into Mt. Doom...","Drinking High Quality H2O..."],e.GetRandomNumber=function(t,e){return Math.floor(Math.random()*(e-t)+t)},e.isLoading=function(){return t.pendingRequests.length>0},e.$watch(e.isLoading,function(t){if(t){var a=e.GetRandomNumber(1,e.LoadingTextArr.length),i=e.LoadingTextArr[a];$(r).children(".loading-text").text(i),$("div.overlay").show(),$(r).show()}else $(r).hide(),$("div.overlay").hide(),$(r).parent().css("background-color","#FFF"),$(r).prev(".BuylistContent").show()})}}}]).directive("search",["$rootScope","$location","$http","$route","System","Buylist",function(t,e,r,a,i,o){return{restrict:"E",scope:{action:"@"},controller:["$scope","$route",function(t,e){t.depts=null,t.$parent.$watchCollection("depts",function(e){e&&(t.depts=e)})}],link:function(r,a,o,n){var s=$(a).children("#searchDiv").children("#searchbar").children("#search-words"),c=$(a).children("#searchDiv").children("#searchbar").children("#selected-department").children("#search-category"),l=$(a).children("#searchDiv").children("#searchbar").children("#search-submit"),u=($(a).children("#searchDiv").children("#searchbar"),"");t.$watch(function(){return e.path()},function(t,e){if(e&&!t)var r=e;else if(e&&t)r=t;else if(!e&&!t)r="/";if("/"==r){var a="";u="",s.css("color","rgb(153,153,153)"),s.css("font-style","italic")}else if(void 0===r&&(r="/"),(r=r.split("/")).length>1&&"search"==r[1]){a=r[2];(u=r[3]).indexOf("|")&&(u=u.replace("|","/")),"All"==a&&(a=""),s.css("color","#000000"),s.css("font-style","normal")}setTimeout(function(){c.val(a)},800),s.val(u)}),s.on("keypress",function(t){if(13==(t.keyCode||t.charCode||t.which)){var e=c.val(),r=s.val();if(r.indexOf("/")&&(r=r.replace("/","|")),""==e&&(e="All"),""==r)alert("You must enter a search term!");else{var a=i.protocol()+"//"+i.hostname()+i.pathname()+"#!/search/"+e+"/"+encodeURI(r);window.location=a}}else""!==$(this).val()&&($(this).css("color","#000000"),$(this).css("font-style","normal"))}),$(document).on("click",".autocomplete-item",function(){u=this.getElementsByTagName("input")[0].value,s.val(u),l.click()});var d=-1;function p(t){if(!t)return!1;!function(t){for(var e=0;e<t.length;e++)t[e].classList.remove("autocomplete-active")}(t),d>=t.length&&(d=0),d<0&&(d=t.length-1),t[d].classList.add("autocomplete-active"),$("#search-words").val(t[d].getElementsByTagName("input")[0].value.replace(/["]+/g,""))}s.on("keydown",function(t){var e=document.getElementById(s.attr("id")+"autocomplete-list");if(e&&(e=e.getElementsByTagName("div")),40==t.keyCode)d++,p(e);else{if(38==t.keyCode)return t.preventDefault(),d--,p(e),!1;13==t.keyCode?(t.preventDefault(),e&&d>-1?e[d].click():l.click()):(t.keyCode>40||t.keyCode<37)&&(d=-1)}}),l.click(function(){var t=c.val(),e=s.val();if(e.indexOf("/")&&(e=e.replace("/","|")),""==t&&(t="All"),""==e)alert("You must enter a search term!");else{var r=i.protocol()+"//"+i.hostname()+i.pathname()+"#!/search/"+t+"/"+encodeURI(e);window.location=r}})},replace:!1,templateUrl:"./templates/search.html"}}]).directive("accountdropdown",function(){return{restrict:"A",link:function(t,e,r){var a=null,i=null;$(e).hover(function(){$(this);"Log In"==$(this).children("a").text()?(a=$("#loginSection"),i=$("#loginBoxWrapper")):(a=$("#infoDropDown"),i=$("#infoDropDownInner")),a.css({display:"block",left:$(e).offset().left,top:$(e).offset().top+$(e).height()+3-$(window).scrollTop()-1,opacity:"1",position:"fixed","z-index":"9999"}),a.show();var t="#"+$(e).attr("id")+", #"+a.attr("id");$(t).mouseout(function(){setTimeout(function(){$(e).is(":hover")||$(a).is(":hover")&&$(i).is(":hover")||setTimeout(function(){$(e).is(":hover")||$(a).is(":hover")&&!$(a).is(":hover")||($(a).hide(),$(a).css({display:"none","z-index":"0"}))},250)},150)})})}}}).directive("logon",["System",function(t){return{restrict:"A",link:function(t,e,r){$(e).click(function(t){var e=$("#emailBox").val(),r=$("#password").val();""==e||""==password?alert("Please enter an e-mail address and password."):(csrfToken=$('meta[name="csrf-token"]').attr("content"),$.ajax({type:"POST",url:"../ajax_scripts/logon.php",data:{action:"buylist",username:e,password:r,csrf_token:csrfToken},dataType:"text",success:function(t){window.location.reload()}}))})}}}]).directive("yourcartdropdown",["System","Buylist","$route","$location",function(t,e,r,a){return{restrict:"A",link:function(t,a,i){$(a).hover(function(){$("#buycart_container").show()}),$("#buylistHeader div.lower #accountDiv div.YourCart, #buycart_container").mouseout(function(){setTimeout(function(){!$("#buylistHeader div.lower #accountDiv div.YourCart:hover").length>0&&!$("#buycart_container:hover").length>0&&setTimeout(function(){0==$("#buylistHeader div.lower #accountDiv div.YourCart:hover").length&&0==$("#buycart_container:hover").length&&$("#buycart_container").hide()},250)},50)}),$("#buycart_container #clear-the-cart").click(function(){var a=$("#buylistHeader .lower #accountDiv .YourCart .YourCartInner .qty_price a").text().split(" ")[2].replace("(","");(a=a.replace(")",""),(a=parseInt(a))>0)&&(confirm("Are you sure you want to clear your cart?")&&(t.ClearCartRequest=e.BuylistAction("clearcart",null,null,null),t.ClearCartRequest.success(function(t,a,i,o){r.reload(),$("#buylistHeader .lower #accountDiv .YourCart .YourCartInner .qty_price a").text("Your Cart (0) $0.00"),e.CartNotification("Buylist Cart has been cleared!")})))}),$("#buycart_container #complete-the-order").click(function(){var t=$("#buylistHeader .lower #accountDiv .YourCart .YourCartInner .qty_price a").text().split(" ")[3];parseFloat(t.replace("$",""))>=30?window.location="./secure/buylistconfirm.php":alert("Your sell order must total at least $30.")})}}}]).directive("breadcrumbs",["$rootScope","$location","$http","System","Buylist",function(t,e,r,a,i){return{restrict:"A",link:function(a,o,n){a.Home='<span><a id="BuylistHomeLink" href="#!/">Buylist Home</a>',a.NavLinks=null,a.Breadcrumb="",a.SentOnce=!1,a.isLoading=function(){return r.pendingRequests.length>0},a.$watch(a.isLoading,function(t){t&&(a.SentOnce=!1)}),t.$watch(function(){return e.path()},function(t,e){if("/"!=t&&t){if(a.deptCode=null,a.catid=null,e&&!t)var r=e;else if(e&&t)r=t;else if(!e&&!t)r="/";"/"!==r&&(r=r.split("/")),"Bulk"==r[1]?(a.Breadcrumb=" > Bulk</span>",$(o).html(a.Home+a.Breadcrumb)):"Hotbuys"==r[1]?(a.Breadcrumb=" > Hot Buys</span>",$(o).html(a.Home+a.Breadcrumb)):"cartreview"==r[1]?(a.Breadcrumb=" > Cart Review</span>",$(o).html(a.Home+a.Breadcrumb)):"search"==r[1]?(a.Breadcrumb=" > Search</span>",$(o).html(a.Home+a.Breadcrumb)):(a.deptCode=r[1],3==r.length&&(a.catid=r[2]),a.GetDeptNameRequest=i.BuylistAction("getdeptname",null,a.deptCode,null),a.GetDeptNameRequest.success(function(t,e,r,n){a.SentOnce=!0,a.deptName=t.deptname,a.Breadcrumb=" > "+a.deptName,$(o).html(a.Home+a.Breadcrumb),a.catid&&("Bulk"==a.catid?(a.Breadcrumb=' > <a href="#!/'+a.deptCode+'">'+a.deptName+"</a> > Bulk</span>",$(o).html(a.Home+a.Breadcrumb)):"Hotbuys"==a.catid?(a.Breadcrumb=' > <a href="#!/'+a.deptCode+'">'+a.deptName+"</a> > Hot Buys</span>",$(o).html(a.Home+a.Breadcrumb)):(a.GetCatNameRequest=i.BuylistAction("getcatname",null,a.deptCode,a.catid),a.GetCatNameRequest.success(function(t,e,r,i){a.SentOnce=!0,a.catname=t.catname,a.Breadcrumb=' > <a href="#!/'+a.deptCode+'">'+a.deptName+"</a> > "+a.catname+"</span>",$(o).html(a.Home+a.Breadcrumb)})))}))}else $(o).html(a.Home)},!0)}}}]).directive("leftnavmenu",["$rootScope","$location","$http",function(t,e,r){return{restrict:"A",link:function(t,a,i){t.NavLinks={},t.isLoading=function(){return r.pendingRequests.length>0},t.$watch(t.isLoading,function(r){if(!r){t.NavLinks=$(a).children("li").children("a");var i=e.path();"/"!==i&&(i=i.split("/")),$.each(t.NavLinks,function(){$(this).hasClass("bold")&&$(this).removeClass("bold")}),i.length>1&&"Hotbuys"!==i[1]&&"cartreview"!==i[1]&&("Bulk"==i[1]&&(i[1]="A"),$.each(t.NavLinks,function(){$(this).attr("data-deptCode")==i[1]&&$(this).addClass("bold")})),$("#BuylistHomeLink").on("click",function(){$.each(t.NavLinks,function(){$(this).hasClass("bold")&&$(this).removeClass("bold")})}),t.NavLinks.on("click",function(){$.each(t.NavLinks,function(){$(this).hasClass("bold")&&$(this).removeClass("bold")}),$(this).addClass("bold")})}})}}}]).directive("howtoselllink",["System",function(t){return{restrict:"A",link:function(e,r,a){$(r).on("click",function(){var e=t.isFromBeta()?t.betaUrl()+"/howToSellGuide":"https://"+t.hostname()+"/HowToSellGuide.php";window.open(e)})}}}]).directive("buylisthomelink",["System",function(t){return{restrict:"A",link:function(e,r,a){$(r).on("click",function(){var e=t.protocol()+"//"+t.hostname()+"/buylist/";window.location=e})}}}]).directive("uploader",["$http","$route","$location","$window","System","Buylist",function(t,e,r,a,i,o){return{restrict:"E",scope:{action:"@"},controller:["$scope",function(t){t.depts=null,t.$parent.$watchCollection("depts",function(e){e&&(t.depts=e)}),t.progress=0,t.sendFile=function(e){alert("Processing the CSV file may take several minutes.");var r=$(e).parents("form");if(""==$(e).val())return!1;r.attr("action",t.action),t.$apply(function(){t.progress=0}),r.ajaxSubmit({type:"POST",uploadProgress:function(e,r,a,i){t.$apply(function(){$("div.overlay").show(),$("div.progress").show(),t.progress=i})},error:function(t,e,a,i){r.removeAttr("action")},success:function(a,i,n,s){var c=$(e).val().split("\\");c[c.length-1];o.CartNotification(JSON.parse(a)),t.$apply(function(){setTimeout(function(){r.attr("action",t.action),t.progress=0,$("div.bar").css("width","0%"),$("div.progress").hide(),$("div.overlay").hide(),t.GetCartRequest=o.GetCart(),t.GetCartRequest.success(function(t,e,r,a){if(1==parseInt(t.response)){var i="Your Cart ("+t.totalqty+") $"+parseFloat(t.totalprice).toFixed(2);$("#accountDiv .YourCart .YourCartInner .qty_price a").text(i)}})},500)})}})}}],link:function(t,e,r,o){$("#selectdept").val($("#selectdept").children("option:first-child").val()),$("#download").on("click",function(){var t=$("#selectdept").val(),e=$("#selectdept option:selected").text(),r=(e=(e=e.trim()).replace(" ",""))+"BuyList.csv",o=i.protocol()+"//"+i.hostname()+"/buylist/ajax_scripts/csv-download.php?deptCode="+t;window.open(o,"_blank"),a.ga&&a.ga("send","event","downloads","click",r)}),$("#filename").on("keypress",function(t){t.preventDefault()}),$("#filename").on("focus",function(t){$(this).blur()}),$("#browse").on("click",function(){$("#csv").trigger("click")}),$("#csv").on("change",function(){var t=$("#csv").val(),e=String(t.match(/\.\w{0,}/g));e=(e=e.replace("[","")).replace("]",""),".csv"!==String(e)?($("#csv").val(""),$("#filename").val("No file selected."),alert("Please select a valid CSV file.")):$("#filename").val(t)})},replace:!1,templateUrl:"./templates/upload.html"}}]).directive("updateproduct",["System","Buylist",function(t,e){return{restrict:"A",link:function(t,r,a){var i,o=r;$(r).focus(function(t){t.target.select(),$(r).mouseup(function(t){t.preventDefault()})}),$(r).bind("keydown",function(t){var a=e.keydown(t);clearTimeout(i),1==a&&$(r).keyup(function(t){clearTimeout(i),i=setTimeout(function(){e.processSellQty(o)},100)})})}}}]).directive("addclick",["System","Buylist",function(t,e){return{restrict:"A",link:function(t,r,a){$(r).children("img").mouseover(function(){var t=$(this).attr("src");t=t.replace("Normal","Hover"),$(this).attr("src",t)}).mouseout(function(){var t=$(this).attr("src");t=t.replace("Hover","Normal"),$(this).attr("src",t)}),$(r).children("img").click(function(){var a=$(r).attr("data-pdid");t.UpdateItemRequest=e.processUpdate("Add",a),t.UpdateItemRequest.success(function(r,i,o,n){if("OK"==r.Response){var s=$("."+a+".buylist_buyqty span").text();s=parseInt(s);var c=$("."+a+".buylist_sellqty input").val(),l='<img src="https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com/media/Buylist2.0/AddtoCartButtonNormal.png" alt="Add To Cart">';if((c=parseInt(c))<s&&(c+=1),c==s&&(l=""),0==c)var u="";else u="x";$("."+a+".buylist_sellqty input").val(c),""==l&&$("."+a+".buylist_add span").html(l),$("."+a+".buylist_clear span").text(u),t.GetCartRequest=e.GetCart(),t.GetCartRequest.success(function(r,a,i,o){if(1==parseInt(r.response)){var n=r.totalqty,s=parseFloat(r.totalprice);t.YourCart="Your Cart ("+n+") $"+s.toFixed(2),$("#accountDiv .YourCart .YourCartInner .qty_price a").text(t.YourCart),e.CartNotification("Item added to Buylist Cart!")}})}})})}}}]).directive("clearclick",["System","Buylist","$route","$location",function(t,e,r,a){return{restrict:"A",link:function(t,a,i){$(a).click(function(){var i=$(a).attr("data-pdid");t.UpdateItemRequest=e.processUpdate("Remove",i),t.UpdateItemRequest.success(function(a,o,n,s){if("OK"==a.Response){var c=$("."+i+".buylist_sellqty input");0==$(c).length&&(c=$("."+i+".cartreview_sellqty input"));var l=String($(c).parent().attr("class"));if("cartreview"!==(l=(l=(l=(l=l.replace(i,"")).replace("_sellqty","")).replace("align_center","")).trim())){$(c).val(0),$("."+i+".buylist_add span").html('<img src="https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com/media/Buylist2.0/AddtoCartButtonNormal.png" alt="Add To Cart">'),$("."+i+".buylist_clear span").text("");var u=$("."+i+".buylist_add").children("span").children("img");u.mouseover(function(){var t=$(this).attr("src");t=t.replace("Normal","Hover"),$(this).attr("src",t)}).mouseout(function(){var t=$(this).attr("src");t=t.replace("Hover","Normal"),$(this).attr("src",t)}),u.click(function(){t.UpdateItemRequest=e.processUpdate("Add",i),t.UpdateItemRequest.success(function(r,a,o,n){if("OK"==r.Response){var s=$("."+i+".buylist_buyqty span").text();s=parseInt(s);var c=$("."+i+".buylist_sellqty input").val(),l='<img src="https://52f4e29a8321344e30ae-0f55c9129972ac85d6b1f4e703468e6b.ssl.cf2.rackcdn.com/media/Buylist2.0/AddtoCartButtonNormal.png" alt="Add To Cart">';if((c=parseInt(c))<s&&(c+=1),c==s&&(l=""),0==c)var u="";else u="x";$("."+i+".buylist_sellqty input").val(c),""==l&&$("."+i+".buylist_add span").html(l),$("."+i+".buylist_clear span").text(u),t.GetCartRequest=e.GetCart(),t.GetCartRequest.success(function(r,a,i,o){if(1==parseInt(r.response)){var n=r.totalqty,s=parseFloat(r.totalprice);t.YourCart="Your Cart ("+n+") $"+s.toFixed(2),$("#accountDiv .YourCart .YourCartInner .qty_price a").text(t.YourCart),e.CartNotification("Item added to Buylist Cart!")}})}})})}else r.reload();t.GetCartRequest=e.GetCart(),t.GetCartRequest.success(function(r,a,o,n){if(1==parseInt(r.response)){var s=r.totalqty,c=parseFloat(r.totalprice);if(t.YourCart="Your Cart ("+s+") $"+c.toFixed(2),"cartreview"==l){$(".cartreview_cart_totalqty.final span").text(s),$(".cartreview_cart_totalprice.final span").text(c.toFixed(2));var u=$("table.cartreview_product_table tbody tr");$.each(u,function(){$(this).attr("data-pdid")==i&&$(this).remove()})}$("#accountDiv .YourCart .YourCartInner .qty_price a").text(t.YourCart),e.CartNotification("Item removed from Buylist Cart!")}})}})})}}}]).directive("completeorder",function(){return{restrict:"A",link:function(t,e,r){$(e).click(function(){var t=$("#buylistHeader .lower #accountDiv .YourCart .YourCartInner .qty_price a").text().split(" ")[3];parseFloat(t.replace("$",""))>=30?window.location="./secure/buylistconfirm.php":alert("Your sell order must total at least $30.")})}}}).directive("productimage",["System",function(t){return{restrict:"A",link:function(t,e,r){$(e).hoverIntent(config={over:function(){var t=$(this).attr("data-productid");t=t.trim();var e={action:"getproductimage",productid:t=parseInt(t)};$.ajax({type:"POST",url:"./ajax_scripts/buylist.php",dataType:"JSON",data:JSON.stringify(e),success:function(t){var e=t.productimageurl,r=$("<div>",{class:"productimage"});r.css("background-color","#FFFFFF"),r.css("position","fixed"),window.scrollY?r.css("top","55px"):r.css("top","155px"),r.css("right","6px"),r.css("width","390px"),r.css("z-index","9998");var a=$("<img>",{src:e});a.css("width","390px"),a.css("z-index","9999"),r.append(a),$("body").append(r),a.show(),$("div.UploadSpreadsheet").hide(),r.show()}})},timeout:150,out:function(){var t=$("div.productimage");$("div.UploadSpreadsheet").show(),t.hide(),t.remove()}})}}}]).directive("stickymenu",["$window","System",function(t,e){return{restrict:"A",link:function(e,r,a){var i=$(r).offset().top;$(t).scroll(function(){var e=t.pageYOffset;$(t).height>=944&&(i<e?$(r).css({position:"fixed",top:10}):$(r).css("position","static"))})}}}]).controller("IndexDeptCtrl",["$scope","System","Buylist",function(t,e,r){t.protocol=e.protocol(),t.hostname=e.hostname(),t.pathname=e.pathname(),t.isFromBeta=e.isFromBeta(),t.betaUrl=e.betaUrl(),t.userid=null,t.usertype=null,t.bulkdept=[{deptCode:"A",deptName:"Bulk"}],t.depts=null,t.YourCart="Your Cart (0) $0.00",t.HomeUrl=t.protocol+"//"+t.hostname,t.BuylistUrl=t.HomeUrl+t.pathname,t.ReturnHome=function(){window.location=e.isFromBeta()?e.betaUrl():t.HomeUrl},t.LogInBtnTxt=null,t.ContactUsBtnTxt="Contact Us",t.GetInitialInfoRequest=r.BuylistAction("initialinfo",null,null,null),t.GetInitialInfoRequest.success(function(e,r,a,i){if(t.depts=e.deptlist,1==parseInt(e.cartcache.response)){var o=e.cartcache.totalqty,n=parseFloat(e.cartcache.totalprice);t.YourCart="Your Cart ("+o+") $"+n.toFixed(2)}var s;(t.userid=e.userinfo.userid,t.usertype=parseInt(e.userinfo.usertype),t.userid>0)?(t.LogInBtnTxt="My Account",(s=new Date).setTime(s.getTime()-3e5),CookieClass.DoesCookieExist("destination")&&CookieClass.SetCookieValue("destination","",{expires:s,path:"/"})):(t.LogInBtnTxt="Log In",(s=new Date).setTime(s.getTime()+3e5),CookieClass.DoesCookieExist("destination")?CookieClass.SetCookieValue("destination",t.BuylistUrl,{expires:s,path:"/"}):CookieClass.CreateCookie("destination",t.BuylistUrl,{expires:s,path:"/"}))})}]).controller("MainController",["$scope","System","Buylist",function(t,e,r){t.LogInUrl=e.isFromBeta()?e.betaUrl()+"/login":"https://"+t.hostname+"/myaccount/index.php"}]).controller("DeptsWithBulkController",["$scope","System","Buylist",function(t,e,r){t.categories=null,t.deptCode="A",t.deptName="Bulk",t.CategoryListRequest=r.BuylistAction("getdeptcategorylist",null,t.deptCode,null),t.CategoryListRequest.success(function(e,r,a,i){t.categories=e})}]).controller("CategoryListController",["$scope","$routeParams","System","Buylist",function(t,e,r,a){t.categories=[],t.deptCode=e.deptCode,t.deptName=null,t.CategoryListRequest=a.BuylistAction("getdeptcategorylist",null,t.deptCode,null),t.CategoryListRequest.success(function(e,r,a,i){$.each(e,function(e,r){var a=r.category_name;a=a.replace("\\",""),r.category_name=a,t.categories.push(r)})})}]).controller("BulkBuylistController",["$scope","$routeParams","System","Buylist",function(t,e,r,a){t.buylist=[],t.deptCode=e.deptCode,t.YourCart="Your Cart (0) $0.00",t.ProductsRequest=a.BuylistAction("getbulkbuylist",null,t.deptCode,null),t.ProductsRequest.success(function(e,r,a,i){$.each(e.product,function(e,r){r.buyqty>0&&t.buylist.push(r)})})}]).controller("HotbuysBuylistController",["$scope","$routeParams","System","Buylist",function(t,e,r,a){t.buylist=[],t.deptCode=e.deptCode,t.YourCart="Your Cart (0) $0.00",t.ProductsRequest=a.BuylistAction("gethotlistbuylist",null,t.deptCode,null),t.ProductsRequest.success(function(e,r,a,i){$.each(e.product,function(e,r){r.buyqty>0&&t.buylist.push(r)})})}]).controller("DeptBuylistController",["$scope","$routeParams","System","Buylist",function(t,e,r,a){t.buylist=[],t.deptCode=e.deptCode,t.catid=e.catid,t.catname=null,t.ProductsRequest=a.BuylistAction("getbuylist",null,t.deptCode,t.catid),t.ProductsRequest.success(function(e,r,a,i){$.each(e.product,function(e,r){"Bulk"!==r.catname&&null==t.catname&&(t.catname=r.catname),r.buyqty>0&&t.buylist.push(r)})})}]).controller("SearchController",["$scope","$route","System","Buylist",function(t,e,r,a){t.buylist=[],t.deptCode=e.current.params.deptCode,t.searchwords=decodeURI(e.current.params.searchwords),t.results=!0,"All"==t.deptCode&&(t.deptCode=null),t.searchwords.indexOf("|")&&(t.searchwords=t.searchwords.replace("|","/")),t.SearchProductsRequest=a.search(t.deptCode,t.searchwords),t.SearchProductsRequest.success(function(e,r,a,i){e.error?t.results=!1:$.each(e.product,function(e,r){r.buyqty>0&&t.buylist.push(r)})})}]).controller("CartReviewController",["$scope","System","Buylist",function(t,e,r){t.cartcache=[],t.YourCart="Your Cart (0) $0.00",t.totalprice=null,t.currentPage=0,t.pageSize=100,t.numberOfPages=0,t.GetNumberOfPages=function(e){return Math.ceil(e.length/t.pageSize)},t.SetCurrentPage=function(e){t.currentPage=e},t.ProductsRequest=r.BuylistAction("loadcartcache",null,null,null),t.ProductsRequest.success(function(e,r,a,i){if(t.response=e.response,1==t.response){if(e.orderid&&(t.orderid=e.orderid),e.totalprice){var o=parseFloat(e.totalprice);t.totalprice=numeral(o).format("0,0.00")}e.totalqty&&(t.totalqty=e.totalqty),$.each(e,function(e,r){var a=e;if(a.substring(0,1).indexOf("_")>-1&&(a=parseInt(a.replace(/_/g,""))),$.isNumeric(a)){var i=r.buyprice;(i=i.trim()).indexOf(",")&&(i=i.replace(",","")),i=parseFloat(i);var o=r.sellqty,n=(o=parseInt(o))*i;i.toFixed(2)/i.toFixed(4)!=1?(i=numeral(i).format("0,0.0000"),r.buyprice=i):(i=numeral(i).format("0,0.00"),r.buyprice=i),r.total=numeral(n).format("0,0.00"),t.cartcache.push(r)}}),t.numberOfPages=t.GetNumberOfPages(t.cartcache)}})}]);